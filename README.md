# 28 Права доступа

## Описание

1. В приложении Каталог создана группа "Модератор продуктов" с правами на редактирование продуктов и настроены необходимые разрешения.
2. Для продуктов добавлено поле "Признак публикации".
3. Просматривать детали продуктов может только зарегистрированный пользователь. Незарегистрированный пользователь может просматривать только список продуктов. Все кнопки на карточках товаров для незарегистрированного пользователя неактивны.
4. Для редактирования статуса публикации или удаления продуктов необходимо быть участником группы "Модератор продуктов". Для модератора продуктов в карточках товаров открывается дополнительная кнопка "Установить признак публикации" и кнопка "Редактировать" становиться активной.
5. Для редактирования и удаления продуктов необходимо быть владельцем продукта. Для владельцев продуктов активны кнопки "Редактировать" и "Удалить", но кнопка "Установить признак публикации" скрыта.

| Пользователь                      | Доступ к деталям | Редактировать | Удалить | Установить признак публикации |
|------------------------------------|-----------------|--------------|---------|--------------------------------|
| Незарегистрированный пользователь | ❌ Нет          | ❌ Нет       | ❌ Нет  | ❌ Нет                         |
| Зарегистрированный пользователь   | ✅ Да           | ❌ Нет       | ❌ Нет  | ❌ Нет                         |
| Владелец продукта                 | ✅ Да           | ✅ Да        | ✅ Да   | ❌ Нет                         |
| Модератор продуктов               | ✅ Да           | ❌ Нет       | ✅ Да   | ✅ Да                          |



## Детали реализации

1. Поле "Признак публикации" представляет собой check-box.
2. Признак публикации продукта изменяется в соответствии с выбором пользователя.
3. Форма для модератора продукта представляет собой обычную форму для редактирования продукта, у которой все поля установлены вв неактивное состояние, за исключением поля "Признак публикации".

![ProductModeratorForm](/media/readme_pic/product_moderator_form.png)

4. Проверка прав доступа для участника группы "Модератор продуктов" реализована через передачу параметра is_moderator в контекст в контроллере продукта.
5. Проверка прав доступа для владельца продукта реализована в шаблоне.
6. Признак публикации продукта сохраняется в базе данных.


## Известные недостатки

1. Для признака публикации продукта согласно ТЗ установлено значение по умолчанию False. Если для карточек продуктов установить проверку таким образом, что публиковаться смогут только карточки имеющие этот признак, то список продуктов будет пустым. Доступ для установки состояния признака продукта в True в этом случае можно будет получить только через админ-панель. Это с моей точки зрения плохая логика. По умолчанию "Признак публикации" продукта должен быть установлен в True. Тогда модератор продуктов сможет при необходимости отменить публикацию, изменив состояние этого поля.
